<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="ca"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>Board.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">JaCoCoverage analysis of project &quot;Snake&quot; (powered by JaCoCo from EclEmma)</a> &gt; <a href="index.source.html" class="el_package">default</a> &gt; <span class="el_source">Board.java</span></div><h1>Board.java</h1><pre class="source lang-java linenums">
import java.awt.Color;
import java.awt.Graphics;
import java.awt.Toolkit;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.KeyAdapter;
import java.awt.event.KeyEvent;
import java.io.File;
import java.io.FileInputStream;
import java.io.InputStream;
import javax.swing.JOptionPane;
import javax.swing.JPanel;
import javax.swing.Timer;
import sun.audio.AudioPlayer;
import sun.audio.AudioStream;

/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
/**
 *
 * @author alu20919409n
 */
public class Board extends JPanel implements ActionListener
{

<span class="fc" id="L30">    class MyKeyAdapter extends KeyAdapter</span>
    {

        @Override
        public void keyPressed(KeyEvent e)
        {
<span class="pc bpc" id="L36" title="2 of 5 branches missed.">            switch (e.getKeyCode())</span>
            {
                case KeyEvent.VK_LEFT:
<span class="pc bpc" id="L39" title="1 of 2 branches missed.">                    if (direction != DirectionType.RIGHT)</span>
                    {
<span class="fc" id="L41">                        direction = DirectionType.LEFT;</span>
                    }

                    break;
                case KeyEvent.VK_RIGHT:
<span class="nc bnc" id="L46" title="All 2 branches missed.">                    if (direction != DirectionType.LEFT)</span>
                    {
<span class="nc" id="L48">                        direction = DirectionType.RIGHT;</span>
                    }
                    break;
                case KeyEvent.VK_UP:
<span class="pc bpc" id="L52" title="1 of 2 branches missed.">                    if (direction != DirectionType.DOWN)</span>
                    {
<span class="fc" id="L54">                        direction = DirectionType.UP;</span>
                    }
                    break;
                case KeyEvent.VK_DOWN:
<span class="pc bpc" id="L58" title="1 of 2 branches missed.">                    if (direction != DirectionType.UP)</span>
                    {
<span class="fc" id="L60">                        direction = DirectionType.DOWN;</span>
                    }
                    break;
                default:
                    break;
            }
<span class="fc" id="L66">            repaint();</span>
<span class="fc" id="L67">        }</span>
    }

    public ScoreBoard scoreBoard;

    public static final int NUM_ROWS = 40;
    public static final int NUM_COLS = 40;
    private int deltaTime;
    private Timer timer;
    boolean directionUp;
    boolean directionDown;
    boolean directionLeft;
    boolean directionRight;
<span class="fc" id="L80">    boolean gameOver = false;</span>
    MyKeyAdapter keyAdapter;
<span class="fc" id="L82">    AudioStream audioSong = null;</span>
<span class="fc" id="L83">    AudioStream audioEffect = null;</span>
    private Food food;
    private SpecialFood specialFood;
    private Snake snake;
<span class="fc" id="L87">    private DirectionType direction = DirectionType.RIGHT;</span>

    public Board()
    {
<span class="fc" id="L91">        super();</span>
<span class="fc" id="L92">        initValues();</span>
<span class="fc" id="L93">        timer = new Timer(deltaTime, this);</span>
<span class="fc" id="L94">        keyAdapter = new MyKeyAdapter();</span>
<span class="fc" id="L95">        setBackground(Color.BLACK);</span>
<span class="fc" id="L96">    }</span>

    public void initValues()
    {
<span class="fc" id="L100">        setFocusable(true);</span>
<span class="fc" id="L101">        deltaTime = 100;</span>
<span class="fc" id="L102">        snake = new Snake(10);</span>
<span class="fc" id="L103">        food=new Food((int)(Math.random()*NUM_ROWS), (int)(Math.random()*NUM_COLS), Color.red);</span>
<span class="fc" id="L104">    }</span>

    public void initGame()
    {
        //AudioPlayer.player.stop(audioSong);
<span class="fc" id="L109">        initValues();</span>

<span class="fc" id="L111">        removeKeyListener(keyAdapter);</span>
<span class="fc" id="L112">        timer.setDelay(deltaTime);</span>
<span class="fc" id="L113">        timer.start();</span>
<span class="fc" id="L114">        addKeyListener(keyAdapter);</span>
<span class="fc" id="L115">        gameOver = false;</span>
        //playSong(&quot;.wav&quot;);
<span class="fc" id="L117">        direction = DirectionType.RIGHT;</span>
<span class="fc" id="L118">    }</span>

    /* private boolean canMoveTo() {
        
    }
     */
    private boolean collisions()
    {
<span class="fc" id="L126">        Node head = snake.listNodes.get(0);</span>
<span class="fc" id="L127">        Node body=null;</span>
<span class="fc bfc" id="L128" title="All 2 branches covered.">        for (int i = 1; i &lt; snake.listNodes.size(); i++)</span>
        {
<span class="fc" id="L130">            body=snake.listNodes.get(i);</span>
<span class="pc bpc" id="L131" title="1 of 4 branches missed.">            if( head.col==body.col &amp;&amp; head.row == body.row)</span>
            {
<span class="nc" id="L133">                return true;</span>
            }
        }
<span class="pc bpc" id="L136" title="1 of 2 branches missed.">        if (head.col &lt; 0)</span>
        {
<span class="nc" id="L138">            return true;</span>
        }

<span class="pc bpc" id="L141" title="1 of 2 branches missed.">        if (head.row &lt; 0)</span>
        {
<span class="nc" id="L143">            return true;</span>
        }

<span class="pc bpc" id="L146" title="1 of 2 branches missed.">        if (head.row &gt; NUM_ROWS+1)</span>
        {
<span class="nc" id="L148">            return true;</span>
        }
<span class="pc bpc" id="L150" title="1 of 2 branches missed.">        if (head.col &gt; NUM_COLS - 1)</span>
        {
<span class="nc" id="L152">            return true;</span>
        }
        
        

<span class="fc" id="L157">        return false;</span>
    }
    public void eat()
    {
<span class="nc" id="L161">        Node head= snake.listNodes.get(0);</span>
<span class="nc bnc" id="L162" title="All 4 branches missed.">        if (head.col==food.col &amp;&amp; head.row==food.row)</span>
        {
<span class="nc" id="L164">            food.col=((int)(Math.random()*NUM_COLS));</span>
<span class="nc" id="L165">            food.row=((int)(Math.random()*NUM_ROWS));</span>
<span class="nc" id="L166">            snake.eat(direction);</span>
        }
<span class="nc" id="L168">    }</span>

    @Override
    public void actionPerformed(ActionEvent ae)
    {
<span class="fc" id="L173">        System.out.println(&quot;Food row: &quot;+food.row+&quot; Food col: &quot;+food.col);</span>
<span class="fc" id="L174">        System.out.println(&quot;Head row: &quot;+snake.listNodes.get(0).row+&quot; Head col: &quot;+snake.listNodes.get(0).col+&quot;\n&quot;);</span>
<span class="pc bpc" id="L175" title="1 of 2 branches missed.">        if (collisions() == true)</span>
        {
<span class="nc" id="L177">            gameOver();</span>
        }
        else
        {
<span class="fc" id="L181">            snake.movement(direction);</span>
<span class="fc" id="L182">            repaint();</span>
<span class="fc" id="L183">            Toolkit.getDefaultToolkit().sync();</span>
        }

<span class="fc" id="L186">    }</span>

    protected void paintComponent(Graphics g)
    {
<span class="fc" id="L190">        super.paintComponent(g);</span>
<span class="fc" id="L191">        snake.draw(g, squareWidth(), squareHeight());</span>
<span class="fc" id="L192">        food.draw(g, squareWidth(), squareHeight());</span>
        // drawBoarder(g);
<span class="fc" id="L194">    }</span>

    /*  public void drawBoarder(Graphics g) {
        g.setColor(Color.red);
        g.drawRect(0, 0, NUM_COLS * squareWidth(), NUM_ROWS * squareHeight());
    }*/
    public void setScoreboard(ScoreBoard scoreboard)
    {
<span class="fc" id="L202">        this.scoreBoard = scoreboard;</span>
<span class="fc" id="L203">    }</span>

    public void playSong(String song)
    {
        InputStream music;
        try
        {
<span class="nc" id="L210">            music = new FileInputStream(new File(song));</span>
<span class="nc" id="L211">            audioSong = new AudioStream(music);</span>
<span class="nc" id="L212">            AudioPlayer.player.start(audioSong);</span>
        }
<span class="nc" id="L214">        catch (Exception e)</span>
        {
<span class="nc" id="L216">            JOptionPane.showMessageDialog(null, e.getLocalizedMessage());</span>
<span class="nc" id="L217">        }</span>
<span class="nc" id="L218">    }</span>

    public void playEffect(String effect)
    {
        InputStream music;
        try
        {
<span class="nc" id="L225">            music = new FileInputStream(new File(effect));</span>
<span class="nc" id="L226">            audioEffect = new AudioStream(music);</span>
<span class="nc" id="L227">            AudioPlayer.player.start(audioEffect);</span>
        }
<span class="nc" id="L229">        catch (Exception e)</span>
        {
<span class="nc" id="L231">            JOptionPane.showMessageDialog(null, e.getLocalizedMessage());</span>
<span class="nc" id="L232">        }</span>
<span class="nc" id="L233">    }</span>

    public void gameOver()
    {
<span class="nc" id="L237">        timer.stop();</span>
<span class="nc" id="L238">        scoreBoard.gameOver();</span>
<span class="nc" id="L239">    }</span>

    private int squareWidth()
    {
<span class="fc" id="L243">        return getWidth() / NUM_COLS;</span>
    }

    private int squareHeight()
    {
<span class="fc" id="L248">        return getHeight() / NUM_ROWS;</span>
    }

}

//deltaTime, food, specialFood, snake/timer
//actionPerformed, gameOver, canMove, checkColision(boolean), checkFood(boolean), eatFood
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.6.201602180812</span></div></body></html>